#!/bin/bash

# Define the project directory (where package.json is located)
PROJECT_DIR="."

# Function to check for and install updates
update_packages() {
  echo "Updating packages..."
  npm outdated --json
  npm update
}

# Function to fix vulnerabilities
fix_vulnerabilities() {
  echo "Fixing vulnerabilities..."
  npm audit fix
  npm audit fix --force
}

# Function to clear and reinstall node modules
reinstall_node_modules() {
  echo "Reinstalling node modules..."
  rm -rf node_modules
  rm package-lock.json
  npm install
}

# Function to run tests
run_tests() {
  echo "Running tests..."
  npm test
}

# Run the defined functions
cd "$PROJECT_DIR"
update_packages
fix_vulnerabilities
reinstall_node_modules
run_tests

echo "All tasks completed successfully."
